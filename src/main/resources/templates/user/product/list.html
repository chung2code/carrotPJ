<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>product</title>
    <link rel="stylesheet" href="/css/list.css" />
</head>
<body>
<div id="wrap">
    <div class="container">
        <!-- 상단헤더 -->
        <div class="header">
            <a class="mainlogo" href="/">
            <span>
              <svg
                      width="65"
                      height="36"
                      viewBox="0 0 65 36"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#clip0_47_13130)">
                  <path
                          d="M9.23186 11.6511C4.1335 11.6511 0 15.6932 0 20.7962C0 27.847 9.25838 31.5884 9.23186 31.5783C9.20661 31.5884 18.4637 27.847 18.4637 20.7962C18.4637 15.6969 14.3302 11.6511 9.23186 11.6511ZM9.23186 24.4985C8.54053 24.498 7.86486 24.2924 7.2903 23.9079C6.71573 23.5233 6.26807 22.977 6.00391 22.338C5.73975 21.6991 5.67096 20.9961 5.80623 20.318C5.9415 19.6399 6.27476 19.0171 6.76388 18.5285C7.25299 18.0398 7.87599 17.7072 8.55411 17.5726C9.23223 17.438 9.93502 17.5076 10.5736 17.7725C11.2122 18.0374 11.7579 18.4857 12.1418 19.0608C12.5256 19.6359 12.7304 20.3119 12.7301 21.0034C12.731 21.4632 12.6411 21.9187 12.4656 22.3437C12.2901 22.7687 12.0325 23.1549 11.7075 23.4802C11.3825 23.8055 10.9966 24.0634 10.5718 24.2392C10.1469 24.415 9.69161 24.5053 9.23186 24.5048V24.4985Z"
                          fill="#FF6F0F"
                  ></path>
                  <path
                          d="M11.3103 0C9.15573 0 7.6554 1.50565 7.41923 3.28415C4.54738 2.4909 2.29688 4.67359 2.29688 7.07354C2.29688 8.9114 3.55978 10.3956 5.24324 10.8781C6.60087 11.2659 9.04586 10.9766 9.04586 10.9766C9.03323 10.383 9.58007 9.73118 10.4237 9.13751C12.8232 7.44996 14.6999 6.65419 14.9891 4.35276C15.2922 1.94523 13.5052 0 11.3103 0Z"
                          fill="#00A05B"
                  ></path>
                  <path
                          d="M36.7873 14.8305C34.8374 15.4431 31.4616 15.769 28.2905 15.769V11.9114H34.8399V9.03906H24.7783V18.8208C30.2808 18.8208 35.0849 18.1576 37.1132 17.5298L36.7873 14.8305Z"
                          fill="#FF6F0F"
                  ></path>
                  <path
                          d="M41.4104 7.89453H37.9033V19.1402H41.4104V15.6148H44.2393V12.5467H41.4104V7.89453Z"
                          fill="#FF6F0F"
                  ></path>
                  <path
                          d="M34.8969 19.1138C31.1814 19.1138 28.4561 21.1613 28.4561 24.1663C28.4561 27.1713 31.1839 29.2188 34.8969 29.2188C38.6098 29.2188 41.3377 27.17 41.3377 24.1663C41.3377 21.1626 38.6124 19.1138 34.8969 19.1138ZM34.8969 26.4058C33.2223 26.4058 31.9657 25.6025 31.9657 24.1613C31.9657 22.72 33.2223 21.9179 34.8969 21.9179C36.5715 21.9179 37.8281 22.7213 37.8281 24.1613C37.8281 25.6012 36.5728 26.4058 34.8969 26.4058Z"
                          fill="#FF6F0F"
                  ></path>
                  <path
                          d="M51.0698 20.6055H47.4844V28.2133H61.735V25.202H51.0698V20.6055Z"
                          fill="#FF6F0F"
                  ></path>
                  <path
                          d="M61.2902 8.83301H47.3224V11.8443H57.7692C57.7692 12.5921 57.8046 14.3706 57.4623 16.3916H44.6514V19.5065H64.1002V16.3966H60.6347C61.0995 13.8426 61.2321 11.8519 61.2902 8.83301Z"
                          fill="#FF6F0F"
                  ></path>
                </g>
                <defs>
                  <clipPath id="clip0_47_13130">
                    <rect width="64.1053" height="36" fill="white"></rect>
                  </clipPath>
                </defs>
              </svg>
            </span>
            </a>

            <nav>
                <li style="color: #ff6f0f">
                    <a href="#">중고거래</a>
                </li>
                <li>
                    <a href="#">동네거래</a>
                </li>
                <li><a href="#">알바</a></li>
                <li><a href="#">부동산 직거래</a></li>
                <li><a href="#">중고차 직거래</a></li>
            </nav>
            <div class="rightform">
                <form novalidate action="#">
                    <svg class="icon" aria-hidden="true" viewBox="0 0 24 24">
                        <g>
                            <path
                                    d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"
                            ></path>
                        </g>
                    </svg>
                    <input
                            placeholder="물품을 검색해보세요"
                            type="search"
                            class="input"
                    />
                </form>
                <div>
                    <button class="chat_btn">채팅하기</button>
                </div>

                <div class="login">
                    <button type="button" onclick="location.href='/user/login'">
                        로그인
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- main -->

    <section class="serv_list">
        <div class="content">
            <div class="title">
                <h1>최신 중고물품</h1>
            </div>

            <!-- 리스트 -->

            <div class="item_list">

                <div th:each="imageBoard,i: ${list}" class="card">
                    <div class="img">
                        <img th:src="@{'/imageboard/'+${imageBoard.username}+'/'+${imageBoard.id}+'/s_'+${imageBoard.files.get(0)}}"alt="Image">


                    </div>
                    <div class="text">
                        <a  th:text="${imageBoard.title}" name="title"></a>
                        <p th:text="${imageBoard.details}" name="details"></p>
                        <p th:text="${imageBoard.place}" name="place"></p>
                        <td> <a class="btn btn-primary" th:href="@{/user/product/read(id=${imageBoard.id})}">사러가기</a></td>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <a class="floating_btn" type="button" href="javascript:openpop()">
        글쓰기
    </a>
    <div class="popup_layer" id="popup_layer" style="display: none">
        <div class="popup_box">
            <div style="height: 10px; width: 100%; float: top; " >
                <a href="javascript:closePop();"
                ><img
                        src="/img/ic_close.svg"
                        class="m_header-banner-close"
                        width="30px"
                        height="30px"
                /></a>
            </div>
            <!--팝업 컨텐츠 영역-->
            <h1>내 물건 팔기</h1>
            <form
                    id="addform"
                    action="/user/product/add"
                    method="post"
                    enctype="multipart/form-data"
            >
                <div class="addcontent">
                    <div class="addimg">

                        <input type="file" name="files" multiple="multiple" />

                    </div>
                    <div class="addcont">

                        <label for="title" >제목</label><br />
                        <input
                                type="text"
                                id="title"
                                name="title"
                                placeholder="제목"
                        />
                    </div>
                    <br />
                    <div class="addcont">

                        <label for="price">가격</label><br />
                        <input
                                type="number"
                                id="price"
                                name="price"
                                placeholder="&#8361; 가격을 입력해주세요"
                        /><br />
                    </div>
                    <div class="addcont">

                        <label for="details">자세한 설명</label><br />
                        <input
                                type="text"
                                id="details"
                                name="details"
                                placeholder="게시글 내용을 작성해 주세요"
                                style="height: 100px;"
                        /><br />
                    </div >
                    <div class="addcont">

                        <label for="place">거래희망장소</label><br />
                        <input
                                type="text"
                                id="place"
                                name="place"

                        /><br />
                    </div >
                    <div class="writebtn">

                        <input class="addbtn" type="submit" value="작성 완료" />
                    </div>
                </div>
            </form>
            <!--팝업 버튼 영역-->
            <div class="popup_btn" style="float: bottom; margin-top: 205px">
                <a href="javascript:closePop();">닫기</a>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
$(document).ready(function(){
  $("#addform").submit(function(event){
    event.preventDefault(); // 기본 submit 동작을 막습니다.

    var formData = new FormData(this); // form의 모든 필드 값을 가져옵니다.

    $.ajax({
      type: "POST",
      url: "/user/product/add",
      data: formData,
      processData: false,  // 필수 : 데이터를 query string으로 변환하는 jQuery 형식을 방지합니다.
      contentType: false,  // 필수 : contentType을 false로 지정하면 브라우저가 formData에 적합한 contentType을 설정합니다.
      success: function(response){
        alert("성공적으로 게시물이 추가되었습니다.");
        closePop();
        window.location.href = "/user/product/list";  // list 페이지로 리다이렉트
      },
      error: function(jqXHR, textStatus, errorThrown){
        alert("게시물 추가 실패 : " + textStatus);
        console.error(errorThrown);
      }
    });
  });
});

function openpop() {
  document.getElementById("popup_layer").style.display = "block";
}

function closePop() {
  document.getElementById("popup_layer").style.display = "none";
}
</script>


    <!-- <button class="floating_btn"type="button" onclick="window.location.href='/user/product/add'">글쓰기</button> -->
    <div class="pagenation col-9">
        <nav aria-label="Page navigation example">
            <ul class="pagination">
                <!-- PREV -->
                <li class="page-item" th:if="${pageDto != null && pageDto.prev}">
                    <a
                            class="page-link"
                            th:href="@{/user/product/list(pageNo=${pageDto.nowBlock * pageDto.pagePerBlock - pageDto.pagePerBlock*2 + 1} )}"
                            aria-label="Previous"
                    >
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <!-- PAGENATION -->
                <th:block
                        th:if="${pageDto != null && pageDto.startPage != null && pageDto.endPage != null && pageDto.startPage <= pageDto.endPage}"
                >
                    <li
                            class="page-item"
                            th:each="i : ${#numbers.sequence(pageDto.startPage, pageDto.endPage)}"
                    >
                        <a
                                class="page-link"
                                th:href="@{/user/product/list(pageNo=${i})}"
                        >
                            <span th:text="${i}"></span>
                        </a>
                    </li>
                </th:block>

                <!-- NEXT -->
                <li class="page-item" th:if="${pageDto != null && pageDto.next}">
                    <a
                            class="page-link"
                            th:href="@{/user/product/list(pageNo=${pageDto.nowBlock*pageDto.pagePerBlock+1} )}"
                            aria-label="Next"
                    >
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>

<!-- 푸터 -->
<footer>
    <div>
        <section>
            <nav>
                <ul>
                    <li>
                        <a href="#">중고거래</a>
                    </li>
                    <li>
                        <a href="#">동네가게</a>
                    </li>
                    <li>
                        <a href="#">당근알바</a>
                    </li>
                    <li>
                        <a href="#">부동산 직거래</a>
                    </li>
                    <li>
                        <a href="#">중고차 직거래</a>
                    </li>
                </ul>
                <ul>
                    <li>
                        <a href="#">당근비즈니스</a>
                    </li>
                    <li>
                        <a href="#">채팅하기</a>
                    </li>
                </ul>
                <ul>
                    <li>
                        <a href="#">자주 묻는 질문</a>
                    </li>
                    <li>
                        <a href="#">회사소개</a>
                    </li>
                    <li>
                        <a href="#">인재채용</a>
                    </li>
                </ul>
            </nav>
        </section>

        <section class="foot_sct2">
            <section class="foot_text1">
                <div>
                    <b>만든이</b>
                    <span> 송재욱 </span>
                </div>
            </section>
            <section class="sns_icon"></section>
            <section class="foot_text2"></section>
        </section>
    </div>
</footer>
</body>
</html>
